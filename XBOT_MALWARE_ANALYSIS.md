# XBot Malware - Complete Technical Analysis

**Malware Family:** XBot / DolphinBot
**Version:** 2.1
**Type:** Twitter Automation Bot / Spam Tool
**Language:** Python 3.13 (PyInstaller-packaged)
**Platform:** Windows x64
**Analysis Date:** 2024-11-14

---

## Executive Summary

XBot is a **commercial Twitter spam bot** sold via Telegram (@PurchaseTwitterXBot) that has been cracked/pirated. It automates the posting of spam messages to Twitter groups and user accounts to promote content. The malware uses browser automation (Playwright), credential storage (keyring), and sophisticated evasion techniques to avoid Twitter's anti-spam detection.

**Threat Level:** HIGH
**Primary Function:** Social media spam and account abuse
**Secondary Functions:** Credential storage, license verification, payment processing

---

## Table of Contents

1. [Malware Capabilities](#malware-capabilities)
2. [Technical Architecture](#technical-architecture)
3. [Functionality Breakdown](#functionality-breakdown)
4. [Configuration & Settings](#configuration--settings)
5. [Persistence Mechanisms](#persistence-mechanisms)
6. [Communication & C2](#communication--c2)
7. [Evasion Techniques](#evasion-techniques)
8. [File Structure](#file-structure)
9. [IOCs](#iocs)
10. [Detection & Mitigation](#detection--mitigation)

---

## Malware Capabilities

### Primary Capabilities

1. **Twitter Account Automation**
   - Automated login to Twitter accounts
   - Mass messaging to groups
   - Direct message spam
   - GIF posting automation
   - Profile following/unfollowing

2. **Credential Management**
   - Stores Twitter OAuth tokens
   - Saves CLIENT_ID and CLIENT_PASSWORD
   - Uses system keyring for credential storage
   - Profile management system (.xbot_profiles.json)

3. **Rate Limit Evasion**
   - Configurable delays between actions
   - Random timing variations
   - Account rotation
   - Detection avoidance ("leniency" settings)

4. **Payment/License System**
   - Cryptocurrency payment integration
   - QR code generation for payments
   - License key validation
   - Tiered pricing (base, upgrade, renew)
   - Coupon system

### Secondary Capabilities

- GUI dashboard (Flet framework)
- Particle animation effects
- Real-time status monitoring
- Scheduled task execution
- Health status checking
- Profile import/export

---

## Technical Architecture

### Component Stack

```
┌─────────────────────────────────────┐
│     XBot.exe (PyInstaller Bundle)   │
├─────────────────────────────────────┤
│  XBot.pyc (Main Application Logic)  │
├─────────────────────────────────────┤
│         Flet GUI Framework          │
├─────────────────────────────────────┤
│      Playwright (Browser Auto)      │
├─────────────────────────────────────┤
│   aiohttp (Async HTTP/API Calls)    │
├─────────────────────────────────────┤
│    Keyring (Credential Storage)     │
├─────────────────────────────────────┤
│  Python 3.13 Runtime (Embedded)     │
└─────────────────────────────────────┘
```

### Key Libraries

| Library | Purpose | Risk Level |
|---------|---------|------------|
| **playwright** | Browser automation for Twitter interaction | HIGH |
| **keyring** | Store Twitter credentials locally | HIGH |
| **aiohttp** | Async HTTP requests to Twitter API | MEDIUM |
| **PIL/Pillow** | Image manipulation (GIFs, screenshots) | LOW |
| **psutil** | System monitoring | MEDIUM |
| **numpy** | Data processing | LOW |
| **pyyaml** | Configuration parsing | LOW |
| **certifi** | SSL/TLS certificates | LOW |

### Execution Flow

```
1. PyInstaller Bootloader Starts
   └─> Extracts Python runtime to %TEMP%\_MEI<random>
   └─> Loads Python 3.13 DLL
   └─> Unmarshals XBot.pyc bytecode

2. XBot Application Initializes
   └─> Creates GUI window (Flet)
   └─> Loads configuration (.xbot_profiles.json, .settings.json)
   └─> Initializes keyring for credentials

3. User Interaction
   └─> Create/Restore Identity screen
   └─> License validation (bypassed in cracked version)
   └─> Main Dashboard appears

4. Bot Operation
   └─> User configures spam settings
   └─> Launches Playwright browser
   └─> Logs into Twitter accounts
   └─> Executes spam drop sequence
   └─> Tracks drops and enforces rate limits

5. Cleanup
   └─> Saves profiles and settings
   └─> Closes browser sessions
   └─> Exits application
```

---

## Functionality Breakdown

### 1. Account Management (`XBotApp.__init__`)

**Purpose:** Manages multiple Twitter accounts for rotation

**Configuration:**
- Stores profiles in `.xbot_profiles.json`
- Each profile contains:
  - Username/email
  - Encrypted password (via keyring)
  - OAuth tokens
  - Account metadata

**Functions:**
```python
_load_profiles_local()      # Load saved profiles
_save_profiles_local()      # Save profiles to disk
_show_add_profile_dialog()  # Add new Twitter account
_profile_row()              # Display profile in UI
_toggle_profiles()          # Enable/disable profiles
```

### 2. Spam Engine

**Core Function:** `_run_automation()`

**Spam Message:**
```
"Hit my pinned post
Please add me to your groups"
```

**Parameters:**
- `drop_limit`: Maximum number of spam drops per session
- `drop_sleep`: Delay between drops (seconds)
- `after_drops`: Action to take after completing drops
- `rate_limit_sleep`: Sleep time when rate limited
- `drop_message`: Custom spam message

**Execution Logic:**
```python
1. Load target list (groups, users, hashtags)
2. For each target:
   a. Check if should skip (followers, invalid room, etc.)
   b. Open conversation/group
   c. Post message + optional GIF
   d. Sleep for drop_sleep seconds
   e. Increment drop_count
   f. If drop_count >= drop_limit: stop
3. Mark session complete
```

### 3. GIF Automation

**Purpose:** Attach GIFs to spam messages to appear more legitimate

**Settings:**
- `gif_keyword`: Search term for GIF (e.g., "hello", "wave")
- `randomize`: Randomize GIF selection
- `no_gif`: Disable GIF attachment

**Function:** Searches Twitter's GIF library and attaches random GIF to message

### 4. Evasion Engine

**Detection Avoidance Settings:**

```python
skip_chudai                      # Skip certain message types
skip_missing_followers           # Skip accounts with 0 followers
skip_non_of_link                 # Skip specific link formats
assume_invalid_room_as_three     # Treat errors as valid rooms

leniency_1_3                     # Detection threshold level 1
leniency_1_4                     # Detection threshold level 2
leniency_2_5                     # Detection threshold level 3
```

**Rate Limiting:**
- Dynamic sleep intervals
- Randomized timing patterns
- Account rotation on rate limit
- Backoff algorithm

### 5. License System (Cracked)

**Original Design:**
- Client contacts license server API (`API_BASE`)
- Validates license key
- Checks expiration date
- Enforces feature restrictions

**Cracked Version:**
- License check bypassed
- All features unlocked
- Warning message: *"Please purchase from @PurchaseTwitterXBot on Telegram instead."*

**Functions:**
```python
_check_license()                 # Validate license key
_show_add_license_dialog()       # Enter license key
_update_license_status()         # Check license expiration
_show_license_type_popup()       # Display license tier
_show_renew_license_dialog()     # Renew expired license
```

### 6. Payment Integration

**Cryptocurrency Support:**
- Bitcoin (BTC)
- Ethereum (ETH)
- Monero (XMR)
- Others (assets/crypto/ contains icons)

**Payment Flow:**
1. User selects license type (base, upgrade, lifetime)
2. Chooses cryptocurrency
3. QR code generated via `https://quickchart.io/qr?text=`
4. User sends payment
5. License activated (in legitimate version)

**Functions:**
```python
PurchaseUI._build_crypto_selector()      # Crypto selection UI
_show_purchase_license_dialog()          # Purchase flow
_handle_crypto_click()                   # Handle crypto selection
_handle_apply_coupon()                   # Apply discount code
```

### 7. Scheduled Execution

**Purpose:** Run spam campaigns at specific times

**Features:**
- Countdown timer
- Scheduled start time
- Recurring execution
- Pause/resume capability

**Functions:**
```python
_set_scheduled()            # Set scheduled time
_scheduled_countdown()      # Countdown display
_show_run_confirmation_dialog()  # Confirm scheduled run
```

### 8. GUI Dashboard

**Framework:** Flet (Python Flutter-based GUI)

**Screens:**
1. **Bootstrap Screen** - Create/Restore Identity
2. **Main Dashboard** - Profile management, settings, execution
3. **Settings Dialog** - Configure spam parameters
4. **Purchase Page** - Buy licenses (non-functional in crack)

**Visual Effects:**
```python
generate_particles()          # Animated background particles
generate_shimmering_dust()    # Shimmering effect
_running_glow()               # Running indicator animation
_idle_breathing()             # Idle pulse animation
_runtime_counter()            # Elapsed time counter
```

---

## Configuration & Settings

### .xbot_profiles.json

Stores account profiles:

```json
{
  "profiles": [
    {
      "id": "unique_id",
      "username": "twitter_handle",
      "email": "user@example.com",
      "client_id": "oauth_client_id",
      "client_password": "encrypted_password",
      "tag": "Profile 1",
      "license_key": "XXXX-XXXX-XXXX"
    }
  ]
}
```

### .settings.json

Global settings:

```json
{
  "all_settings": {
    "drop_limit": 50,
    "drop_sleep": 5,
    "rate_limit_sleep": 60,
    "gif_keyword": "hello",
    "randomize": true,
    "no_gif": false,
    "skip_missing_followers": true,
    "leniency_1_3": true,
    "group_skip": [],
    "drop_message": "Hit my pinned post..."
  },
  "saved_profiles": {
    "Default": { /* settings */ },
    "Aggressive": { /* settings */ }
  }
}
```

---

## Persistence Mechanisms

### File Persistence

1. **Configuration Files**
   - `.xbot_profiles.json` - Saved to user directory
   - `.settings.json` - Saved to user directory
   - Both loaded on startup

2. **Windows Registry (via keyring)**
   - Credentials stored in Windows Credential Manager
   - Service: `XBot`
   - Keys: `XBot:client_id`, `XBot:password`

### No Startup Persistence

**Important:** XBot does NOT install:
- Registry Run keys
- Startup folder shortcuts
- Scheduled tasks
- Windows services

It only persists data, not execution.

---

## Communication & C2

### Network Communication

1. **Twitter API (via Playwright)**
   - Automated browser interactions
   - No direct API calls (avoids API rate limits)
   - Uses full browser session

2. **License Server (Disabled in Crack)**
   - Original endpoint: `API_BASE` (value not revealed in strings)
   - Validates licenses
   - Checks for updates
   - Tracks usage

3. **Payment QR Codes**
   - `https://quickchart.io/qr?text=<wallet_address>`
   - Generates QR codes for crypto payments

4. **Font Loading**
   - `https://rsms.me/inter/font-files/Inter-Regular.otf?v=3.19`
   - Loads Inter font for GUI

### Telegram Contact

- **Original Seller:** @PurchaseTwitterXBot on Telegram
- Used for:
  - Purchasing licenses
  - Customer support
  - Updates/announcements

---

## Evasion Techniques

### 1. Anti-Detection

**Rate Limiting:**
- Variable sleep intervals
- Randomized timing
- Gradual ramp-up
- Exponential backoff on errors

**Behavioral Mimicry:**
- Human-like typing speeds
- Random mouse movements (via Playwright)
- Natural reading delays
- Varied message templates

**Account Rotation:**
- Multiple account support
- Automatic switching on ban
- Separate sessions per account

### 2. Anti-Analysis

**Python 3.13:**
- Uses newest Python version
- Incompatible with most decompilers
- Bytecode format not widely supported

**PyInstaller:**
- Compressed bytecode (PYZ archive)
- Encrypted resources
- Runtime extraction to temp directory
- Cleanup on exit

### 3. Error Handling

**Graceful Degradation:**
```python
try:
    # Perform spam action
except RateLimitError:
    sleep(rate_limit_sleep)
except InvalidRoomError:
    if assume_invalid_room_as_three:
        continue
except:
    log_error()
    pause_bot()
```

---

## File Structure

### XBot.exe_extracted/

```
XBot.exe_extracted/
├── XBot.pyc                    # Main malware logic (200KB)
├── PYZ.pyz                     # Compressed Python modules
├── python313.dll               # Python 3.13 runtime
├── background.jpg              # GUI background image
├── base_library.zip            # Standard library modules
│
├── assets/
│   ├── crypto/                 # Cryptocurrency icons
│   ├── icon/                   # Application icon
│   └── qr/                     # QR code templates
│
├── Libraries:
│   ├── _asyncio.pyd            # Async I/O
│   ├── _socket.pyd             # Networking
│   ├── _ssl.pyd                # SSL/TLS
│   └── playwright/             # Browser automation
│
└── Dependencies:
    ├── aiohttp/                # HTTP client
    ├── keyring/                # Credential storage
    ├── PIL/                    # Image processing
    ├── numpy/                  # Numerical processing
    └── psutil/                 # System utilities
```

---

## IOCs (Indicators of Compromise)

### File Indicators

```
Filenames:
- XBot.exe
- .xbot_profiles.json
- .settings.json
- background.jpg (in temp directory)

Paths:
- %TEMP%\_MEI<random>\
- %USERPROFILE%\.xbot_profiles.json
- %USERPROFILE%\.settings.json

Registry Keys:
- HKCU\Software\Python Keyring\XBot
```

### Network Indicators

```
URLs:
- https://rsms.me/inter/font-files/Inter-Regular.otf?v=3.19
- https://quickchart.io/qr?text=*

Domains:
- rsms.me
- quickchart.io
- twitter.com (automated access)
- x.com (automated access)

Telegram:
- @PurchaseTwitterXBot
```

### String Indicators

```
Unique Strings:
- "XBot V2.1"
- "DolphinBot"
- "Hit my pinned post Please add me to your groups"
- "@PurchaseTwitterXBot"
- ".xbot_profiles.json"
- "PyInstallerOnefileHiddenWindow"

Settings:
- drop_limit
- drop_sleep
- rate_limit_sleep
- gif_keyword
- skip_chudai
```

### Behavioral Indicators

```
Process:
- XBot.exe spawns playwright browser processes
- Creates hidden window class: PyInstallerOnefileHiddenWindow
- Accesses Windows Credential Manager

File Operations:
- Creates/modifies .xbot_profiles.json
- Creates/modifies .settings.json
- Extracts files to %TEMP%\_MEI*

Network:
- Automated Twitter.com access
- QR code generation requests
- Font file download
```

---

## Detection & Mitigation

### YARA Rules

See `xbot_detection.yar` for complete YARA signatures.

**Key Detection Strings:**
- "XBot V2.1"
- "@PurchaseTwitterXBot"
- "DolphinBot"
- ".xbot_profiles.json"
- Combination of Playwright + keyring + specific strings

### Sigma Rules

See `xbot_detection.yml` for Sigma rules.

**Detection Logic:**
- Process creation: XBot.exe
- File creation in %TEMP%\_MEI*
- Credential Manager access
- Browser automation via Playwright

### Behavioral Detection

**Monitor for:**
1. Rapid Twitter post activity from single account
2. Repeated identical messages
3. GIF attachments to all messages
4. Account switching patterns
5. Playwright/browser automation processes

### Prevention

**Platform Level (Twitter):**
- Rate limiting enforcement
- Identical message detection
- Automated behavior detection
- CAPTCHA challenges
- Account verification requirements

**Endpoint Level:**
- Application whitelisting
- Block unsigned executables
- Monitor PyInstaller artifacts
- Restrict browser automation tools
- Credential access monitoring

### Remediation

If XBot is found on a system:

1. **Immediate Actions:**
   - Disconnect from network
   - Terminate XBot.exe process
   - Kill any playwright/browser processes

2. **Evidence Collection:**
   - Copy .xbot_profiles.json (contains credentials)
   - Copy .settings.json
   - Capture memory dump if needed
   - Check %TEMP% for _MEI* directories

3. **Credential Reset:**
   - All Twitter accounts in profiles.json are compromised
   - Reset passwords immediately
   - Revoke OAuth tokens
   - Enable 2FA

4. **Cleanup:**
   - Delete XBot.exe
   - Delete .xbot_profiles.json
   - Delete .settings.json
   - Clear %TEMP%\_MEI* directories
   - Remove from Windows Credential Manager

5. **Investigation:**
   - Check Twitter account activity logs
   - Review sent messages for spam
   - Identify affected contacts
   - Report to Twitter abuse team

---

## Conclusion

XBot is a **sophisticated social media automation tool** designed for Twitter spam campaigns. While marketed as a legitimate "growth" tool, its primary function is platform abuse and spam distribution.

### Key Takeaways

1. **Not Traditional Malware:** XBot doesn't steal data or encrypt files, but it:
   - Abuses social media platforms
   - Stores user credentials
   - Facilitates spam/scam campaigns

2. **Commercial Tool:** Originally sold on Telegram with:
   - License system
   - Payment integration
   - Customer support
   - This is a cracked version

3. **Technical Sophistication:**
   - Modern Python 3.13
   - Browser automation (Playwright)
   - Evasion techniques
   - Professional GUI

4. **Detection Challenges:**
   - PyInstaller packing
   - Legitimate libraries used maliciously
   - Newest Python version
   - Behavioral mimicry

### Threat Assessment

**To Twitter/X Platform:** HIGH
- Enables mass spam campaigns
- Evades rate limiting
- Abuses legitimate accounts

**To End Users:** MEDIUM
- Stores credentials (risk of exposure)
- Association with spam (account bans)
- Potential legal consequences

**To Enterprise:** LOW
- Not designed for corporate targeting
- No data exfiltration
- No lateral movement

---

## References

- PyInstaller Documentation: https://pyinstaller.org/
- Playwright Documentation: https://playwright.dev/
- Python Keyring: https://github.com/jaraco/keyring
- Flet Framework: https://flet.dev/

**Analysis Tools Used:**
- Ghidra (for bootloader analysis)
- pyinstxtractor (for archive extraction)
- Python dis module (for bytecode disassembly)
- strings utility (for string extraction)

---

**Document Version:** 1.0
**Last Updated:** 2024-11-14
**Analyst:** Security Research Team
**Classification:** TLP:WHITE (Shareable)
